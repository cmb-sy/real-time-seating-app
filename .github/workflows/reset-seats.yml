name: Reset Seats Scheduler

on:
  schedule:
    # 毎日21時0分に実行（UTC 12:00）
    - cron: "0 12 * * *"
  # 手動実行用のトリガー
  workflow_dispatch:

jobs:
  reset-seats:
    runs-on: ubuntu-latest
    steps:
      - name: Reset seats data
        run: |
          curl -X POST ${{ secrets.RESET_API_ENDPOINT }} \
            -H "Content-Type: application/json" \
            -d '{"authorization":"${{ secrets.RESET_API_KEY }}"}'
      - name: Check result
        run: |
          if [ $? -ne 0 ]; then
            echo "座席リセットに失敗しました"
            exit 1
          else
            echo "座席リセットが完了しました"
          fi
